/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/sklearn/base.py:318: UserWarning: Trying to unpickle estimator MinMaxScaler from version 1.0.1 when using version 1.2.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(
/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Downloading: "https://download.pytorch.org/models/vgg11-bbd30ac9.pth" to /cluster/home/metzgern/.cache/torch/hub/checkpoints/vgg11-bbd30ac9.pth
Command Line Args:   --no-osm --satmode --num_epochs 100 --lam_builtmask 0.0 --batch_size 384 --lr_step 10 -lr 3e-4 --lr_step 15 --lr_gamma 0.75 --model JacobsUNet --feature_extractor vgg11 --loss l1_loss --lam 1000 --lam_adv 100.0 -S2 --feature_dim 16 --random_season --target_region pri2017 --adversarial --save-dir /cluster/work/igp_psr/metzgern/HAC/code/PopMapResults --head v1 --classifier v2
Defaults:
  --dataset:         So2Sat
  --target_regions:  []
  --weightdecay:     0.0
  --lassoreg:        0.0
  --tv:              0.0
  --gradient_clip:   0.01
  --lam_dense:       1.0
  --num_workers:     10
  --wandb_project:   POMELOv2
  --logstep_train:   20
  --val_every_n_epochs:1
  --seed:            1610
  --save-model:      both
  --max_samples:     1000000000000000.0


  0%|          | 0.00/507M [00:00<?, ?B/s]
  0%|          | 56.0k/507M [00:00<27:30, 322kB/s]
  0%|          | 224k/507M [00:00<09:22, 944kB/s] 
  0%|          | 552k/507M [00:00<04:42, 1.88MB/s]
  0%|          | 1.18M/507M [00:00<03:00, 2.93MB/s]
  1%|          | 2.87M/507M [00:00<01:12, 7.25MB/s]
  1%|▏         | 6.46M/507M [00:00<00:32, 16.2MB/s]
  2%|▏         | 12.2M/507M [00:00<00:17, 29.3MB/s]
  3%|▎         | 15.3M/507M [00:01<00:20, 24.8MB/s]
  4%|▍         | 20.4M/507M [00:01<00:15, 32.3MB/s]
  5%|▍         | 23.8M/507M [00:01<00:15, 32.0MB/s]
  6%|▌         | 28.9M/507M [00:01<00:15, 32.6MB/s]
  7%|▋         | 34.5M/507M [00:01<00:12, 39.2MB/s]
  8%|▊         | 40.1M/507M [00:01<00:11, 44.3MB/s]
  9%|▉         | 44.5M/507M [00:01<00:13, 36.7MB/s]
 10%|▉         | 50.4M/507M [00:01<00:11, 42.7MB/s]
 11%|█         | 55.1M/507M [00:02<00:12, 37.1MB/s]
 12%|█▏        | 60.4M/507M [00:02<00:11, 41.5MB/s]
 13%|█▎        | 66.1M/507M [00:02<00:10, 45.9MB/s]
 14%|█▍        | 70.8M/507M [00:02<00:11, 38.9MB/s]
 15%|█▌        | 76.1M/507M [00:02<00:10, 42.9MB/s]
 16%|█▌        | 80.9M/507M [00:02<00:10, 44.6MB/s]
 17%|█▋        | 86.1M/507M [00:02<00:11, 39.3MB/s]
 18%|█▊        | 90.7M/507M [00:02<00:10, 41.3MB/s]
 19%|█▉        | 95.2M/507M [00:03<00:10, 43.0MB/s]
 20%|█▉        | 99.7M/507M [00:03<00:09, 43.9MB/s]
 21%|██        | 104M/507M [00:03<00:09, 44.6MB/s] 
 21%|██▏       | 109M/507M [00:03<00:09, 45.5MB/s]
 22%|██▏       | 113M/507M [00:03<00:10, 39.1MB/s]
 23%|██▎       | 118M/507M [00:03<00:09, 41.5MB/s]
 24%|██▍       | 122M/507M [00:03<00:09, 43.5MB/s]
 25%|██▌       | 127M/507M [00:03<00:08, 45.1MB/s]
 26%|██▌       | 132M/507M [00:03<00:08, 46.0MB/s]
 27%|██▋       | 136M/507M [00:04<00:09, 39.1MB/s]
 28%|██▊       | 141M/507M [00:04<00:09, 41.5MB/s]
 29%|██▊       | 146M/507M [00:04<00:08, 43.9MB/s]
 30%|██▉       | 150M/507M [00:04<00:08, 45.5MB/s]
 31%|███       | 155M/507M [00:04<00:08, 45.8MB/s]
 31%|███▏      | 159M/507M [00:04<00:09, 39.1MB/s]
 32%|███▏      | 164M/507M [00:04<00:08, 41.8MB/s]
 33%|███▎      | 169M/507M [00:04<00:08, 43.4MB/s]
 34%|███▍      | 173M/507M [00:04<00:07, 45.2MB/s]
 35%|███▌      | 178M/507M [00:04<00:07, 46.2MB/s]
 36%|███▌      | 183M/507M [00:05<00:08, 39.3MB/s]
 37%|███▋      | 187M/507M [00:05<00:07, 42.1MB/s]
 38%|███▊      | 192M/507M [00:05<00:07, 44.7MB/s]
 39%|███▉      | 197M/507M [00:05<00:07, 45.0MB/s]
 40%|███▉      | 202M/507M [00:05<00:06, 46.5MB/s]
 41%|████      | 206M/507M [00:05<00:08, 39.4MB/s]
 42%|████▏     | 211M/507M [00:05<00:07, 41.8MB/s]
 42%|████▏     | 215M/507M [00:05<00:07, 42.7MB/s]
 43%|████▎     | 220M/507M [00:06<00:06, 43.4MB/s]
 44%|████▍     | 225M/507M [00:06<00:06, 45.5MB/s]
 45%|████▌     | 229M/507M [00:06<00:06, 45.8MB/s]
 46%|████▌     | 233M/507M [00:06<00:07, 38.9MB/s]
 47%|████▋     | 238M/507M [00:06<00:06, 41.8MB/s]
 48%|████▊     | 243M/507M [00:06<00:06, 42.9MB/s]
 49%|████▉     | 248M/507M [00:06<00:05, 45.5MB/s]
 50%|████▉     | 253M/507M [00:06<00:05, 46.6MB/s]
 51%|█████     | 257M/507M [00:06<00:06, 39.4MB/s]
 52%|█████▏    | 262M/507M [00:07<00:05, 42.8MB/s]
 53%|█████▎    | 266M/507M [00:07<00:05, 42.8MB/s]
 53%|█████▎    | 271M/507M [00:07<00:05, 44.3MB/s]
 54%|█████▍    | 276M/507M [00:07<00:06, 38.8MB/s]
 55%|█████▌    | 281M/507M [00:07<00:05, 41.9MB/s]
 56%|█████▋    | 285M/507M [00:07<00:05, 43.0MB/s]
 57%|█████▋    | 290M/507M [00:07<00:05, 43.2MB/s]
 58%|█████▊    | 294M/507M [00:07<00:05, 43.6MB/s]
 59%|█████▉    | 299M/507M [00:07<00:04, 45.9MB/s]
 60%|█████▉    | 303M/507M [00:08<00:05, 39.4MB/s]
 61%|██████    | 307M/507M [00:08<00:05, 39.9MB/s]
 62%|██████▏   | 312M/507M [00:08<00:04, 42.9MB/s]
 62%|██████▏   | 317M/507M [00:08<00:04, 42.0MB/s]
 63%|██████▎   | 321M/507M [00:08<00:04, 43.7MB/s]
 64%|██████▍   | 326M/507M [00:08<00:04, 44.8MB/s]
 65%|██████▌   | 330M/507M [00:08<00:04, 40.2MB/s]
 66%|██████▌   | 335M/507M [00:08<00:04, 43.6MB/s]
 67%|██████▋   | 340M/507M [00:08<00:04, 41.9MB/s]
 68%|██████▊   | 345M/507M [00:09<00:03, 44.7MB/s]
 69%|██████▉   | 350M/507M [00:09<00:04, 40.9MB/s]
 70%|██████▉   | 354M/507M [00:09<00:03, 43.7MB/s]
 71%|███████   | 359M/507M [00:09<00:03, 42.2MB/s]
 72%|███████▏  | 364M/507M [00:09<00:03, 45.5MB/s]
 73%|███████▎  | 369M/507M [00:09<00:03, 41.1MB/s]
 74%|███████▍  | 374M/507M [00:09<00:03, 43.8MB/s]
 75%|███████▍  | 378M/507M [00:09<00:03, 42.3MB/s]
 75%|███████▌  | 383M/507M [00:10<00:03, 42.0MB/s]
 77%|███████▋  | 388M/507M [00:10<00:02, 41.7MB/s]
 78%|███████▊  | 393M/507M [00:10<00:02, 44.1MB/s]
 78%|███████▊  | 398M/507M [00:10<00:02, 42.7MB/s]
 80%|███████▉  | 403M/507M [00:10<00:02, 45.9MB/s]
 80%|████████  | 408M/507M [00:10<00:02, 41.1MB/s]
 81%|████████▏ | 413M/507M [00:10<00:02, 44.2MB/s]
 82%|████████▏ | 417M/507M [00:10<00:02, 42.1MB/s]
 83%|████████▎ | 422M/507M [00:10<00:01, 45.5MB/s]
 84%|████████▍ | 427M/507M [00:11<00:02, 40.5MB/s]
 85%|████████▌ | 431M/507M [00:11<00:01, 41.9MB/s]
 86%|████████▌ | 436M/507M [00:11<00:01, 42.9MB/s]
 87%|████████▋ | 442M/507M [00:11<00:01, 46.2MB/s]
 88%|████████▊ | 446M/507M [00:11<00:01, 41.1MB/s]
 89%|████████▉ | 451M/507M [00:11<00:01, 43.8MB/s]
 90%|████████▉ | 456M/507M [00:11<00:01, 42.5MB/s]
 91%|█████████ | 461M/507M [00:11<00:01, 46.0MB/s]
 92%|█████████▏| 465M/507M [00:12<00:01, 40.6MB/s]
 93%|█████████▎| 471M/507M [00:12<00:00, 44.6MB/s]
 94%|█████████▍| 475M/507M [00:12<00:00, 42.8MB/s]
 95%|█████████▍| 481M/507M [00:12<00:00, 46.3MB/s]
 96%|█████████▌| 485M/507M [00:12<00:00, 40.5MB/s]
 97%|█████████▋| 490M/507M [00:12<00:00, 41.8MB/s]
 98%|█████████▊| 495M/507M [00:12<00:00, 44.2MB/s]
 99%|█████████▊| 500M/507M [00:12<00:00, 40.3MB/s]
100%|█████████▉| 505M/507M [00:13<00:00, 43.0MB/s]
100%|██████████| 507M/507M [00:13<00:00, 40.7MB/s]
wandb: Currently logged in as: nandometzger. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.14.0
wandb: Run data is saved locally in /cluster/work/igp_psr/metzgern/HAC/code/PopMapResults/So2Sat/experiment_0_947/wandb/run-20230328_071204-cykrhfll
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-shape-407
wandb: ⭐️ View project at https://wandb.ai/nandometzger/POMELOv2
wandb: 🚀 View run at https://wandb.ai/nandometzger/POMELOv2/runs/cykrhfll
Model JacobsUNet ; #Params: 14494997

  0%|          | 0/100 [00:00<?, ?it/s]
  0%|          | 0/100 [00:00<?, ?it/s, best_validation_loss=nan, training_loss=nan, validation_loss=nan]

  0%|          | 0/496 [00:00<?, ?it/s][A

  0%|          | 0/496 [00:00<?, ?it/s, training_loss=nan][A/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 10 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(


                                                          [A
  0%|          | 0/100 [00:03<?, ?it/s, best_validation_loss=nan, training_loss=nan, validation_loss=nan]
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.038 MB of 0.038 MB uploaded (0.000 MB deduped)
wandb: \ 0.038 MB of 0.038 MB uploaded (0.000 MB deduped)
wandb: | 0.038 MB of 0.038 MB uploaded (0.000 MB deduped)
wandb: / 0.038 MB of 0.038 MB uploaded (0.000 MB deduped)
wandb: - 0.038 MB of 0.038 MB uploaded (0.000 MB deduped)
wandb: 🚀 View run sandy-shape-407 at: https://wandb.ai/nandometzger/POMELOv2/runs/cykrhfll
wandb: Synced 6 W&B file(s), 0 media file(s), 3 artifact file(s) and 1 other file(s)
wandb: Find logs at: /cluster/work/igp_psr/metzgern/HAC/code/PopMapResults/So2Sat/experiment_0_947/wandb/run-20230328_071204-cykrhfll/logs
Traceback (most recent call last):
  File "run_train.py", line 495, in <module>
    trainer.train()
  File "run_train.py", line 116, in train
    self.train_epoch(tnr)
  File "run_train.py", line 157, in train_epoch
    for i, sample in enumerate(inner_tnr):
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/dataloader.py", line 1333, in _next_data
    return self._process_data(data)
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/dataloader.py", line 1359, in _process_data
    data.reraise()
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/_utils.py", line 543, in reraise
    raise exception
rasterio.errors.RasterioIOError: Caught RasterioIOError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "rasterio/_base.pyx", line 308, in rasterio._base.DatasetBase.__init__
  File "rasterio/_base.pyx", line 219, in rasterio._base.open_dataset
  File "rasterio/_err.pyx", line 221, in rasterio._err.exc_wrap_pointer
rasterio._err.CPLE_OpenFailedError: /scratch/metzgern/HAC/data/So2Sat_POP_Part1/train/00179_22835_birmingham/sen2summer/Class_11/1kmN3322E3525_sen2summer.tif: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 302, in _worker_loop
    data = fetcher.fetch(index)
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/data/So2Sat.py", line 92, in __getitem__
    X, Pop_X, PopNN_X, pop_avail, msb, msb_avail = self.data_generation(ID_temp)
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/data/So2Sat.py", line 170, in data_generation
    data.append(self.generate_data(ID_sen2, channels=3, data='sen2spring'))
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/data/So2Sat.py", line 216, in generate_data
    with rasterio.open(ID_temp, 'r') as ds:
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/rasterio/env.py", line 451, in wrapper
    return f(*args, **kwds)
  File "/cluster/work/igp_psr/metzgern/HAC/code/repocode/PopMap2/PopMapEnv/lib64/python3.8/site-packages/rasterio/__init__.py", line 304, in open
    dataset = DatasetReader(path, driver=driver, sharing=sharing, **kwargs)
  File "rasterio/_base.pyx", line 310, in rasterio._base.DatasetBase.__init__
rasterio.errors.RasterioIOError: /scratch/metzgern/HAC/data/So2Sat_POP_Part1/train/00179_22835_birmingham/sen2summer/Class_11/1kmN3322E3525_sen2summer.tif: No such file or directory

